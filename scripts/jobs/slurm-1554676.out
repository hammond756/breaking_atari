Starting short_job_template.job 1554676
Finished loading models
------
Starting SpaceInvadersDeterministic-v4 on cuda
Namespace(batch_size=32, environment='SpaceInvadersDeterministic-v4', eps_start=1.0, eps_steps=10000, eps_stop=0.1, eval_every=2500, exploration_phase=500, frame_stack=4, gamma=0.99, grid_size=[32, 42], lr=0.00025, memory=1000, n_object_types=8, num_eval=10000, num_frames=10000, output_dir='/scratch/dev_new_envs_handcrafted', sprites_dir='/scratch/space_invader_sprites/', target_update=1000)
------
0 / 10000 frames done
100 / 10000 frames done
200 / 10000 frames done
300 / 10000 frames done
400 / 10000 frames done
500 / 10000 frames done
600 / 10000 frames done
700 / 10000 frames done
800 / 10000 frames done
900 / 10000 frames done
1000 / 10000 frames done
1100 / 10000 frames done
1200 / 10000 frames done
1300 / 10000 frames done
1400 / 10000 frames done
1500 / 10000 frames done
1600 / 10000 frames done
1700 / 10000 frames done
1800 / 10000 frames done
1900 / 10000 frames done
2000 / 10000 frames done
2100 / 10000 frames done
2200 / 10000 frames done
2300 / 10000 frames done
2400 / 10000 frames done
/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/gym/envs/registration.py:14: PkgResourcesDeprecationWarning: Parameters to load are deprecated.  Call .resolve and .require separately.
  result = entry_point.load(False)
Traceback (most recent call last):
  File "../dqn/train_handcrafted.py", line 55, in <module>
    train(model, target, env, config)
  File "/home/arond/breaking_atari/dqn/train.py", line 119, in train
    avg_q = evaluate_q_func(model, val_states)
  File "/home/arond/breaking_atari/dqn/train.py", line 148, in evaluate_q_func
    predictions = model(val_states)
  File "/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/torch/nn/modules/module.py", line 477, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/arond/breaking_atari/dqn/model/dqn.py", line 143, in forward
    return self.net(x)
  File "/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/torch/nn/modules/module.py", line 477, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/torch/nn/modules/container.py", line 91, in forward
    input = module(input)
  File "/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/torch/nn/modules/module.py", line 477, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/torch/nn/modules/linear.py", line 55, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/arond/breaking_atari/.venv/lib/python3.5/site-packages/torch/nn/functional.py", line 1026, in linear
    output = input.matmul(weight.t())
RuntimeError: size mismatch, m1: [81920 x 210], m2: [10752 x 300] at /pytorch/aten/src/THC/generic/THCTensorMathBlas.cu:249
end of job
